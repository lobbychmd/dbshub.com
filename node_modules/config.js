var mongo = require('mongoskin');

exports.db = function () {
    return mongo.db('MIS:MISSOLUTION@222.73.240.112:27017/idc');
};

exports.auth_config = {
    sysfuncs: {
        'friend': { doc: null, name: '浏览日志' },
        'visiter': { doc: 'Project', name: '浏览项目' },
        'developer': { doc: 'Project', name: '开发项目' }
    },
    sysroles: {
        'friend': { name: '好友', funcs: ['friend'] },
        'dev': { name: '项目成员', funcs: ['visiter', 'developer'] } //要求所有的 funcs 的 doc 必须一样
    }
}

exports.doctree_config = {
    root: {
        children: [
            { middleware: 'summary', type: 'tables', text: '数据结构' },
            { middleware: 'summary', type: 'themes', text: '主题' },
            { middleware: 'summary', type: 'connections', text: '数据连接' },
            { middleware: 'summary', type: 'modules', text: '模块(菜单）' },
            { middleware: 'summary', type: 'bizes', text: '业务逻辑' },
            { middleware: 'summary', type: 'queries', text: '查询' },
            { middleware: 'summary', type: 'fields', text: '数据字典' },
        ]

    },
    tables: {
        children: [
            { middleware: 'summary', type: 'table', text: '所有表' },
            { middleware: 'az', type: 'table', params:{ prefix: 't'} }
        ]
    },
    table: {table: 'MetaTable', text: 'TableName'},
    themes: {
        children: [
            { query:  {ProjectName: '5072868317f07b7013002040'}, type: 'theme' }
        ]
    },
    theme: {table: 'MetaTheme', text: 'Theme'},
    connections: {
        children: [
            { middleware: 'az', type: 'connection' }
        ]
    },
    connection: {table: 'MetaConnection', text: 'ConnName'},
    bizes: {children: [
            { middleware: 'az', type: 'biz' }
        ]
    },
    biz: { table: 'MetaBiz',text: 'BizID' },
    queries: {children: [
            { middleware: 'az', type: 'query' }
        ]
    },
    query: {table: 'MetaQuery', text: 'QueryName' },
    fields: {children: [
            { middleware: 'az', type: 'field' }
        ]
    },
    field: {table: 'MetaField', text: 'FieldName' },
    modules: {
        text: 'TableName', 
        children: [
            { type: 'module', query: {ProjectName: '5072868317f07b7013002040', ParentID:''} }
        ]
    },
    "module": {
        table: 'MetaModule',
        text: 'Caption',
        fields:['ModuleID'],
        children: [
            { type: 'module', query: {ProjectName: '5072868317f07b7013002040', ParentID:'{ModuleID}'} }
        ]
    }
}

 